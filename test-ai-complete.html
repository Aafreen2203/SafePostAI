<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SafePost AI - Complete AI Testing</title>
    <style>
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        margin: 0;
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      }

      .header {
        text-align: center;
        margin-bottom: 40px;
      }

      .header h1 {
        color: #2c3e50;
        margin: 0;
        font-size: 2.5em;
        font-weight: 700;
      }

      .header .subtitle {
        color: #7f8c8d;
        font-size: 1.2em;
        margin-top: 10px;
      }

      .test-section {
        background: white;
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 30px;
        border: 2px solid #ecf0f1;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      }

      .test-section h2 {
        color: #2c3e50;
        margin-top: 0;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .test-section h3 {
        color: #34495e;
        margin-top: 25px;
        margin-bottom: 15px;
      }

      .input-group {
        margin-bottom: 25px;
      }

      .input-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #2c3e50;
      }

      textarea,
      input[type="text"],
      input[type="file"] {
        width: 100%;
        padding: 15px;
        border: 2px solid #bdc3c7;
        border-radius: 10px;
        font-size: 16px;
        font-family: inherit;
        transition: all 0.3s ease;
        box-sizing: border-box;
      }

      textarea:focus,
      input:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
      }

      .image-upload-area {
        border: 3px dashed #bdc3c7;
        border-radius: 15px;
        padding: 40px;
        text-align: center;
        background: #f8f9fa;
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .image-upload-area:hover {
        border-color: #3498db;
        background: #ecf0f1;
      }

      .image-upload-area.dragover {
        border-color: #2ecc71;
        background: #d5f4e6;
      }

      .upload-icon {
        font-size: 48px;
        margin-bottom: 15px;
        color: #7f8c8d;
      }

      .test-samples {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .sample-card {
        background: #f8f9fa;
        border: 2px solid #dee2e6;
        border-radius: 10px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .sample-card:hover {
        border-color: #3498db;
        background: #e8f4fd;
      }

      .sample-card h4 {
        margin: 0 0 10px 0;
        color: #2c3e50;
      }

      .sample-card p {
        margin: 0;
        color: #7f8c8d;
        font-size: 14px;
      }

      .sample-text {
        background: #f1f2f6;
        padding: 10px;
        border-radius: 5px;
        font-family: monospace;
        font-size: 13px;
        margin-top: 10px;
        white-space: pre-wrap;
        word-break: break-word;
      }

      .api-status {
        background: #e8f4fd;
        border: 2px solid #3498db;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 30px;
      }

      .status-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }

      .status-indicator {
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
      }

      .status-configured {
        background: #d5f4e6;
        color: #27ae60;
      }

      .status-missing {
        background: #fadbd8;
        color: #e74c3c;
      }

      .status-fallback {
        background: #fef9e7;
        color: #f39c12;
      }

      .instructions {
        background: #fff3cd;
        border: 2px solid #ffeaa7;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 30px;
      }

      .instructions h3 {
        margin-top: 0;
        color: #856404;
      }

      .instructions ol {
        margin: 15px 0;
        padding-left: 20px;
      }

      .instructions li {
        margin-bottom: 8px;
        color: #856404;
      }

      .btn {
        background: #3498db;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn:hover {
        background: #2980b9;
        transform: translateY(-2px);
      }

      .btn-secondary {
        background: #95a5a6;
      }

      .btn-secondary:hover {
        background: #7f8c8d;
      }

      @media (max-width: 768px) {
        .container {
          padding: 20px;
        }

        .test-samples {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üõ°Ô∏è SafePost AI</h1>
        <div class="subtitle">Complete AI-Powered Privacy Testing</div>
      </div>

      <div class="instructions">
        <h3>üöÄ Setup Instructions</h3>
        <ol>
          <li>Load the SafePost AI extension and ensure it's enabled</li>
          <li>Right-click on the extension icon ‚Üí <strong>Options</strong></li>
          <li>
            In Advanced Features, add your OpenAI or HuggingFace API key
            (optional but recommended)
          </li>
          <li>Ensure "Enable AI-powered privacy analysis" is checked</li>
          <li>Save settings and return to this page</li>
          <li>Try typing sensitive information in the text areas below</li>
          <li>
            Upload or drag images with text containing sensitive information
          </li>
        </ol>
      </div>

      <div class="api-status" id="apiStatus">
        <h3>üîß API Status</h3>
        <div class="status-item">
          <span>OpenAI API:</span>
          <span class="status-indicator status-missing" id="openaiStatus"
            >Not Configured</span
          >
        </div>
        <div class="status-item">
          <span>HuggingFace API:</span>
          <span class="status-indicator status-missing" id="hfStatus"
            >Not Configured</span
          >
        </div>
        <div class="status-item">
          <span>Fallback (Regex):</span>
          <span class="status-indicator status-configured"
            >Always Available</span
          >
        </div>
      </div>

      <!-- Text Analysis Section -->
      <div class="test-section">
        <h2>‚úçÔ∏è AI Text Privacy Analysis</h2>
        <p>
          Type or paste sensitive information to test AI-powered privacy
          detection:
        </p>

        <div class="input-group">
          <label for="socialPost">Social Media Post:</label>
          <textarea
            id="socialPost"
            rows="4"
            placeholder="Type your social media post here... Try including personal information to see SafePost AI in action!"
          ></textarea>
        </div>

        <div class="input-group">
          <label for="emailDraft">Email Draft:</label>
          <textarea
            id="emailDraft"
            rows="3"
            placeholder="Draft an email... Include addresses, phone numbers, or other sensitive info to test detection."
          ></textarea>
        </div>

        <div class="input-group">
          <label for="commentText">Comment or Reply:</label>
          <input
            type="text"
            id="commentText"
            placeholder="Write a comment... Test with credit card numbers, SSNs, etc."
          />
        </div>

        <h3>üß™ Sample Sensitive Content</h3>
        <p>
          Click any sample below to automatically fill the social post field:
        </p>

        <div class="test-samples">
          <div class="sample-card" onclick="fillSample('pii')">
            <h4>üÜî Personal Information</h4>
            <p>Email, phone, address, SSN</p>
            <div class="sample-text">
              Hey everyone! Just moved to 123 Main St, New York, NY 10001. Call
              me at (555) 123-4567 or email john.doe@email.com. My SSN is
              123-45-6789 for verification.
            </div>
          </div>

          <div class="sample-card" onclick="fillSample('financial')">
            <h4>üí≥ Financial Information</h4>
            <p>Credit cards, bank details</p>
            <div class="sample-text">
              Just bought this with my card 4532 1234 5678 9012, expires 12/25,
              CVV 123. Bank account: 987654321 at routing 021000021.
            </div>
          </div>

          <div class="sample-card" onclick="fillSample('medical')">
            <h4>üè• Medical/Health Data</h4>
            <p>Health conditions, medical IDs</p>
            <div class="sample-text">
              Diagnosed with diabetes yesterday. Medical ID: MRN-789456123.
              Insurance policy: HLT-987-654-321. Need insulin shots daily now.
            </div>
          </div>

          <div class="sample-card" onclick="fillSample('work')">
            <h4>üíº Work-Related Sensitive Info</h4>
            <p>Employee IDs, internal info</p>
            <div class="sample-text">
              Employee ID: EMP-12345, salary $85,000/year. Project codename
              "Phoenix" launching Q2. CEO meeting notes confidential.
            </div>
          </div>

          <div class="sample-card" onclick="fillSample('location')">
            <h4>üìç Location & Travel</h4>
            <p>GPS coordinates, travel plans</p>
            <div class="sample-text">
              Currently at coordinates 40.7128, -74.0060. Flying to LA tomorrow,
              flight AA1234. Hotel: Marriott Downtown, room 1205.
            </div>
          </div>

          <div class="sample-card" onclick="fillSample('family')">
            <h4>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family & Children</h4>
            <p>Kids' schools, family details</p>
            <div class="sample-text">
              My daughter Sarah (8) goes to Lincoln Elementary, class 3B. Son
              Mike (12) at Jefferson Middle School. Babysitter is Maria: (555)
              987-6543.
            </div>
          </div>
        </div>
      </div>

      <!-- Image Analysis Section -->
      <div class="test-section">
        <h2>üñºÔ∏è AI Image Privacy Analysis</h2>
        <p>Upload or drag images containing text with sensitive information:</p>

        <div class="input-group">
          <label for="imageUpload">Choose Image File:</label>
          <input type="file" id="imageUpload" accept="image/*" multiple />
        </div>

        <div class="image-upload-area" id="dropZone">
          <div class="upload-icon">üì∑</div>
          <div>
            <strong>Drag & Drop Images Here</strong><br />
            or click to select files
          </div>
          <div style="margin-top: 10px; font-size: 14px; color: #7f8c8d">
            Supported: JPG, PNG, GIF, WebP<br />
            SafePost AI will extract and analyze text from images
          </div>
        </div>

        <h3>üß™ Sample Image Types to Test</h3>
        <div class="test-samples">
          <div class="sample-card">
            <h4>üìÑ Document Screenshots</h4>
            <p>Screenshots of forms, IDs, documents with personal info</p>
          </div>

          <div class="sample-card">
            <h4>üí¨ Chat Screenshots</h4>
            <p>Text message screenshots containing addresses, phone numbers</p>
          </div>

          <div class="sample-card">
            <h4>üè™ Receipt Photos</h4>
            <p>Receipt images with credit card numbers, addresses</p>
          </div>

          <div class="sample-card">
            <h4>üìß Email Screenshots</h4>
            <p>Email content with sensitive information</p>
          </div>
        </div>
      </div>

      <!-- Test Actions -->
      <div class="test-section">
        <h2>üîß Test Actions</h2>

        <button class="btn" onclick="openOptions()">
          ‚öôÔ∏è Open Extension Options
        </button>

        <button class="btn btn-secondary" onclick="checkExtensionStatus()">
          üìä Check Extension Status
        </button>

        <button class="btn btn-secondary" onclick="clearAllInputs()">
          üóëÔ∏è Clear All Inputs
        </button>

        <button class="btn btn-secondary" onclick="refreshApiStatus()">
          üîÑ Refresh API Status
        </button>
      </div>
    </div>

    <script>
      // Sample data for testing
      const sampleTexts = {
        pii: "Hey everyone! Just moved to 123 Main St, New York, NY 10001. Call me at (555) 123-4567 or email john.doe@email.com. My SSN is 123-45-6789 for verification.",
        financial:
          "Just bought this with my card 4532 1234 5678 9012, expires 12/25, CVV 123. Bank account: 987654321 at routing 021000021.",
        medical:
          "Diagnosed with diabetes yesterday. Medical ID: MRN-789456123. Insurance policy: HLT-987-654-321. Need insulin shots daily now.",
        work: "Employee ID: EMP-12345, salary $85,000/year. Project codename 'Phoenix' launching Q2. CEO meeting notes confidential.",
        location:
          "Currently at coordinates 40.7128, -74.0060. Flying to LA tomorrow, flight AA1234. Hotel: Marriott Downtown, room 1205.",
        family:
          "My daughter Sarah (8) goes to Lincoln Elementary, class 3B. Son Mike (12) at Jefferson Middle School. Babysitter is Maria: (555) 987-6543.",
      };

      function fillSample(type) {
        const textarea = document.getElementById("socialPost");
        textarea.value = sampleTexts[type];
        textarea.focus();

        // Trigger input event to activate SafePost AI
        const event = new Event("input", { bubbles: true });
        textarea.dispatchEvent(event);
      }

      function openOptions() {
        if (chrome && chrome.runtime) {
          chrome.runtime.openOptionsPage();
        } else {
          alert(
            'Please right-click on the SafePost AI extension icon and select "Options"'
          );
        }
      }

      function checkExtensionStatus() {
        console.log("üîç SafePost AI Extension Status Check");
        console.log("Current URL:", window.location.href);
        console.log(
          "SafePost elements:",
          document.querySelectorAll('[class*="safepost"]').length
        );

        // Check if content script is loaded
        if (window.safepostAI) {
          console.log("‚úÖ SafePost AI content script loaded");
          alert("‚úÖ SafePost AI is active on this page!");
        } else {
          console.log("‚ùå SafePost AI content script not detected");
          alert(
            "‚ùå SafePost AI not detected. Please reload the extension and refresh this page."
          );
        }
      }

      function clearAllInputs() {
        document.getElementById("socialPost").value = "";
        document.getElementById("emailDraft").value = "";
        document.getElementById("commentText").value = "";
        document.getElementById("imageUpload").value = "";

        // Remove any SafePost warnings
        document
          .querySelectorAll('[class*="safepost"]')
          .forEach((el) => el.remove());
      }

      async function refreshApiStatus() {
        try {
          const result = await chrome.storage.local.get([
            "openaiApiKey",
            "huggingfaceApiKey",
          ]);

          const openaiStatus = document.getElementById("openaiStatus");
          const hfStatus = document.getElementById("hfStatus");

          if (result.openaiApiKey && result.openaiApiKey.trim()) {
            openaiStatus.textContent = "Configured";
            openaiStatus.className = "status-indicator status-configured";
          } else {
            openaiStatus.textContent = "Not Configured";
            openaiStatus.className = "status-indicator status-missing";
          }

          if (result.huggingfaceApiKey && result.huggingfaceApiKey.trim()) {
            hfStatus.textContent = "Configured";
            hfStatus.className = "status-indicator status-configured";
          } else {
            hfStatus.textContent = "Not Configured";
            hfStatus.className = "status-indicator status-missing";
          }
        } catch (error) {
          console.error("Failed to check API status:", error);
        }
      }

      // Drag and drop functionality for images
      const dropZone = document.getElementById("dropZone");
      const imageUpload = document.getElementById("imageUpload");

      dropZone.addEventListener("click", () => {
        imageUpload.click();
      });

      dropZone.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropZone.classList.add("dragover");
      });

      dropZone.addEventListener("dragleave", (e) => {
        e.preventDefault();
        dropZone.classList.remove("dragover");
      });

      dropZone.addEventListener("drop", (e) => {
        e.preventDefault();
        dropZone.classList.remove("dragover");

        const files = e.dataTransfer.files;
        if (files.length > 0) {
          imageUpload.files = files;
          const event = new Event("change", { bubbles: true });
          imageUpload.dispatchEvent(event);
        }
      });

      // Initialize page
      document.addEventListener("DOMContentLoaded", () => {
        refreshApiStatus();

        // Add console message
        console.log(`
üõ°Ô∏è SafePost AI - Complete AI Testing Page Loaded

This page tests both text and image analysis with AI-powered privacy detection.

Features being tested:
‚úÖ Real-time text analysis in textareas and inputs
‚úÖ Image upload and drag-and-drop with OCR analysis  
‚úÖ AI-powered privacy detection (OpenAI/HuggingFace)
‚úÖ Fallback to regex-based detection
‚úÖ Visual warnings and privacy alerts

Try typing sensitive information or uploading images with text!
            `);
      });
    </script>
  </body>
</html>
